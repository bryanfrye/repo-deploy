---

name: Bootstrap New Infrastructure Repo

description: >
  GitHub-native workflow to generate a new infrastructure repository skeleton
  (AWS, Azure, or GCP) using GitHub Actions and script-based generation.

.github/workflows/bootstrap.yaml:
  name: Bootstrap New Infrastructure Repo

  on:
    workflow_dispatch:
      inputs:
        repo_name:
          description: "Name of the new repository to create"
          required: true
        cloud_provider:
          description: "Cloud provider to scaffold for"
          required: true
          type: choice
          options:
            - aws
            - azure
            - gcp
        linters:
          description: "Select linters to configure"
          required: false
          type: choice
          options:
            - yaml
            - python
            - shell
            - ruby
            - puppet
            - ansible
            - markdown
            - cloudformation
            - terraform
          multiple: true
        description:
          description: "Project description (optional)"
          required: false

  jobs:
    scaffold:
      runs-on: ubuntu-latest
      environment: production
      steps:
        - name: Checkout repo-deploy
          uses: actions/checkout@v3

        - name: Install GitHub CLI
          uses: cli/gh-action@v2

        - name: Run bootstrap script
          env:
            GH_TOKEN: ${{ secrets.GH_TOKEN }}
          run: |
            chmod +x bootstrap/scripts/bootstrap.sh
            ./bootstrap/scripts/bootstrap.sh \
              --repo-name "${{ github.event.inputs.repo_name }}" \
              --provider "${{ github.event.inputs.cloud_provider }}" \
              --linters "${{ join(github.event.inputs.linters, ',') }}" \
              --description "${{ github.event.inputs.description }}"
